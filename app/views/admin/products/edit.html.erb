<% provide(:title, 'Update Product') %>
<div class="container-fluid">
  <div class="row">
    <%# --Sidebar %>
    <%= render partial:'admin/home/side_bar' %>
    <%# --Sidebar %>

    <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
      <div class="pt-3 pb-2 mb-3 border-bottom">
        <h1 class="h2">Product Update</h1>
      </div>

      <div class="table-responsive">

        <section class="text-left d-flex justify-content-start">
          <div class="mt-2">
            <h5> Update product </h5>
              <%= form_with model: @product, url: admin_product_path, method: :put do |f| %>
            <div class="mb-3 row">
              <label class="col-sm-2 col-form-label">Name:</label>
              <div class="col-sm-10">
                <%= f.text_field :name, value: @product.name, class: 'form-control' %>
                <p class="text-danger"><%= @errors.messages[:name].first if @errors.present? %></p>
              </div> 
            </div>

            <div class="mb-3 row">
              <label class="col-sm-2 col-form-label">Image:</label>
              <div class="col-sm-10">
                <%=f.file_field :image,value: @product.image,accept: "image/jpeg, image/gif, image/png, image/jpg", class:'form-control'%>
                <p class="text-danger"><%= @errors.messages[:image].first if @errors.present? %></p>
              </div> 
            </div>

            <div class="mb-3 row">
              <label class="col-sm-2 col-form-label">Image:</label>
              <div class="col-sm-10">
                <%= f.fields_for :product_attachments do |image_form| %>
                <%= image_form.file_field :image, multiple: false, name: 'product[product_attachments_attributes][image][]', accept: "image/jpeg, image/gif, image/png, image/jpg", class:'form-control'%>
                <% end %>
              </div> 
            </div>

            <div class="mb-3 row">
              <label class="col-sm-2 col-form-label">Price:</label>
              <div class="col-sm-10">
                <%= f.text_field :price, value: @product.price, class: 'form-control' %>
                <p class="text-danger"><%= @errors.messages[:price].first if @errors.present? %></p>
              </div> 
            </div>

            <div class="mb-3 row">
              <label class="col-sm-3 col-form-label">Description:</label>
              <div class="col-sm-12">
                <%= f.text_area :description, value: @product.description, class: 'form-control' %>
              </div> 
            </div>

            <div class="mb-3 row">
              <label class="col-sm-3 col-form-label">Categories:</label>
              <div class="col-sm-12">
                <%= f.select :category_id, Category.all.collect {|category| [category.name, category.id]}, {  }, { include_blank: true, class:'form-select' } %>
                <p class="text-danger"><%= @errors.messages[:category_id].first if @errors.present? %></p>
              </div> 
            </div>
          
            <div class='d-flex'>
              <%=  f.submit 'Update', class:"btn btn-dark d-block  btn-submit", data: { disable_with: 'Update' } %>
              <%= link_to "Back", admin_products_path, class:'ms-2 btn btn-link d-block' %>
            </div>
            <% end  %>
          </div>
        </section>

      </div>
    </main>
  </div>
</div>